# PIK Apartment Tracker

Система отслеживания цен на квартиры от застройщика ПИК (pik.ru).

## Возможности

- Отслеживание квартир по нескольким жилым комплексам
- Фильтрация по параметрам: цена, этаж, комнаты, площадь
- История изменения цен
- Автоматическая проверка по расписанию (cron)
- Email-уведомления о новых квартирах и изменениях цен
- Приятный веб-интерфейс

## Требования

- PHP 7.4+ с расширениями: PDO, SQLite3, cURL, JSON
- Веб-сервер (Apache/Nginx)
- Доступ к cron (для автоматических проверок)

## Установка

### 1. Загрузите файлы на хостинг

```bash
git clone https://github.com/yourusername/PIK_apartment_search.git
# или загрузите архив через FTP
```

### 2. Настройте права доступа

```bash
chmod 755 /path/to/pik-tracker
chmod 777 /path/to/pik-tracker/data
```

### 3. Настройте конфигурацию

Отредактируйте `config.php`:

```php
return [
    // Email для уведомлений (опционально)
    'email' => [
        'enabled' => true,
        'from' => 'noreply@yourdomain.com',
        'to' => 'your@email.com',
        // SMTP настройки если нужно
    ],
];
```

### 4. Настройте cron-задачу

Добавьте в crontab для автоматической проверки:

```bash
# Проверка каждые 6 часов
0 */6 * * * php /path/to/pik-tracker/cron.php >> /path/to/logs/pik.log 2>&1
```

### 5. Откройте в браузере

Перейдите по адресу вашего сайта и начните использовать!

## Использование

### Первый запуск

1. Перейдите на вкладку "Проекты"
2. Нажмите "Синхронизировать" для загрузки списка ЖК
3. Отметьте галочками интересующие вас проекты
4. Вернитесь на вкладку "Квартиры"
5. Нажмите "Обновить данные с PIK"

### Фильтрация

Используйте боковую панель для фильтрации:
- Выберите конкретный ЖК
- Укажите диапазон комнат
- Установите ценовой диапазон
- Задайте площадь и этаж

### Сохранение фильтров

1. Настройте нужные фильтры
2. Нажмите "Сохранить фильтр"
3. Укажите название и email для уведомлений
4. Система будет присылать уведомления о подходящих квартирах

### Настройка уведомлений

На вкладке "Настройки":
1. Включите email-уведомления
2. Укажите email
3. Выберите интервал проверки

## Структура проекта

```
PIK_apartment_search/
├── index.html          # Главная страница
├── config.php          # Конфигурация
├── cron.php            # Скрипт для cron
├── .htaccess           # Защита Apache
├── api/
│   ├── handler.php     # API обработчик
│   ├── Database.php    # Работа с БД
│   ├── PikApi.php      # Клиент API PIK
│   └── Mailer.php      # Email уведомления
├── assets/
│   ├── css/style.css   # Стили
│   └── js/app.js       # JavaScript
└── data/
    └── apartments.db   # SQLite база (создается автоматически)
```

## API Endpoints

Внутренний API (`api/handler.php`):

| Action | Метод | Описание |
|--------|-------|----------|
| `get_projects` | GET | Список проектов |
| `sync_projects` | GET | Синхронизация с PIK |
| `track_project` | POST | Отметить проект для отслеживания |
| `get_apartments` | GET | Список квартир с фильтрами |
| `fetch_apartments` | GET | Загрузить данные с PIK |
| `get_filters` | GET | Сохраненные фильтры |
| `save_filter` | POST | Сохранить фильтр |
| `get_stats` | GET | Статистика |
| `test_api` | GET | Проверка подключения к PIK |

## Безопасность

- База данных защищена через .htaccess
- Конфигурационный файл недоступен из веба
- cron.php можно запустить только из командной строки
- Все данные хранятся локально

## Известные ограничения

- API PIK может измениться без предупреждения
- При большом количестве запросов возможна блокировка IP
- Рекомендуемый интервал проверки: не чаще 1 раза в час

## Troubleshooting

### База данных не создается
Проверьте права на запись в директорию `data/`

### Не загружаются проекты
Проверьте подключение к интернету и доступность api.pik.ru

### Email не приходят
- Проверьте настройки SMTP
- Проверьте папку "Спам"
- Используйте тест в настройках

## Лицензия

MIT License

## Отказ от ответственности

Этот проект не связан с ГК ПИК. Используйте на свой риск.
Данные получаются из публичного API pik.ru.
